var ExceptionHandler=function(a){return this.serverUrl=a.serverUrl||"",this.cb=a.cb||function(){},this.token=a.token||null,this.method=this.getMethod(a),this.maxRequests=a.maxRequests||-1,this.pageUrl=window.location.href,this.shouldLog=a.shouldLog||null,this.getBrowserInfo(),this.errors=[],this};ExceptionHandler.prototype.watch=function(){var a=this;return window.onerror=function(b,c,d,e){var f={message:b,url:c,line:d,column:e};a.maxRequests>0&&a.errors.length<=a.maxRequests&&(a.report(f),a.errors.push(f))},this},ExceptionHandler.prototype.report=function(a){var b=["message="+a.message,"&file="+a.url,"&line="+a.line,"&column="+a.column,"&date="+new Date,"&ismobile="+this.isMobile,"&os="+this.os,"&browser="+this.browser,"&version="+this.version,"&url="+this.pageUrl].join("");this.shouldLog&&console.log("Bug tracker: ",b),this.sendRequest(encodeURI(b),this.cb)},ExceptionHandler.prototype.sendRequest=function(a,b){var c=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");c.onreadystatechange=function(){var a=4===c.readyState&&200===c.status?c.responseText:c.status;"undefined"!=typeof b&&4===c.readyState&&b(a)},c.open(this.method,this.serverUrl,!0),c.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.token&&c.setRequestHeader(this.token.key,this.token.value),c.send(a)},ExceptionHandler.prototype.getMethod=function(a){var b=a.method;return b&&-1!=["POST","GET"].indexOf(b.toUpperCase())?b.toUpperCase():"POST"},ExceptionHandler.prototype.isMobile=function(){return null!==navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)|(android)|(webOS)/i)},ExceptionHandler.prototype.getOs=function(){return-1!=navigator.appVersion.indexOf("Win")?"Windows":-1!=navigator.appVersion.indexOf("Mac")?"MacOS":-1!=navigator.appVersion.indexOf("X11")?"UNIX":-1!=navigator.appVersion.indexOf("Linux")?"Linux":"Unknown OS"},ExceptionHandler.prototype.getBrowserInfo=function(){var a,b,c,d=navigator.userAgent;-1!=(verOffset=d.indexOf("Opera"))?(a="Opera",b=d.substring(verOffset+6),-1!=(verOffset=d.indexOf("Version"))&&(b=d.substring(verOffset+8))):-1!=(verOffset=d.indexOf("MSIE"))?(a="Microsoft Internet Explorer",b=d.substring(verOffset+5)):-1!=(verOffset=d.indexOf("Chrome"))?(a="Chrome",b=d.substring(verOffset+7)):-1!=(verOffset=d.indexOf("Safari"))?(a="Safari",b=d.substring(verOffset+7),-1!=(verOffset=d.indexOf("Version"))&&(b=d.substring(verOffset+8))):-1!=(verOffset=d.indexOf("Firefox"))?(a="Firefox",b=d.substring(verOffset+8)):(nameOffset=d.lastIndexOf(" ")+1)<(verOffset=d.lastIndexOf("/"))&&(a=d.substring(nameOffset,verOffset),b=d.substring(verOffset+1),a.toLowerCase()==a.toUpperCase()&&(a=navigator.appName)),-1!=(c=b.indexOf(";"))&&(b=b.substring(0,c)),-1!=(c=b.indexOf(" "))&&(b=b.substring(0,c)),majorVersion=parseInt(""+b,10),isNaN(majorVersion)&&(b=""+parseFloat(navigator.appVersion),majorVersion=parseInt(navigator.appVersion,10)),this.browser=a,this.version=b,this.isMobile=this.isMobile(),this.os=this.getOs()};